                     ┌─────────────────────────┐
                     │   Compromised EC2 VM    │
                     │  Instance Profile Role  │
                     │  (AssumedRole, no MFA)  │
                     └───────────┬─────────────┘
                                 │
                                 │ Uses temporary credentials
                                 ▼
                    ┌────────────────────────────┐
                    │      AWS STS / IAM         │
                    │   Validates credentials    │
                    └───────────┬────────────────┘
                                │
                                │ Authenticated as:
                                │ principalId:
                                │   AROA5FLZVX4OAMSW6BCRH:i-0317f...
                                │ accessKeyId:
                                │   ASIA5FLZVX4OPVKKVBMX
                                ▼
             ┌─────────────────────────────────────────┐
             │            S3 Enumeration               │
             │  eventName = ListBuckets (x2)           │
             │  eventName = ListObjects (multiple)     │
             └───────────────────┬─────────────────────┘
                                 │
                                 │ Identifies bucket:
                                 │   mordors3stack-s3bucket-llp2yingx64a
                                 ▼
       ┌───────────────────────────────────────────────────────┐
       │                Targeted Bucket Access                 │
       │   Repeated ListObjects calls → probing contents       │
       │   MFAAuthenticated = false                            │
       │   userAgent = AWS CLI on macOS                        │
       └─────────────────────────┬─────────────────────────────┘
                                 │
                                 │ Finds object: ring.txt
                                 ▼
              ┌─────────────────────────────────────────┐
              │             Data Exfiltration           │
              │       eventName = GetObject (x2)        │
              │    Object: ring.txt                     │
              │    bytesTransferredOut = 89 bytes       │
              └────────────────────────┬────────────────┘
                                       │
                                       │ No further activity:
                                       │   • No IAM changes
                                       │   • No privilege escalation
                                       │   • No EC2, STS, Lambda events
                                       │   • No lateral movement
                                       ▼
                      ┌────────────────────────────────┐
                      │         Attack Ends            │
                      │ Single-vector exfiltration     │
                      │ Scope limited to S3 bucket     │
                      └────────────────────────────────┘
