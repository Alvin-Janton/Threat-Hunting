## ðŸ“ Data Directory

This directory contains all datasets generated throughout the project, including the original CloudTrail logs, filtered S3-related subsets, enriched/flattened datasets, and extended IoC pivot searches.

Each subfolder groups data by its purpose in the analysis workflow.

---

### ðŸ“‚ cleaned_data/

Output of `enrich_s3_events.py` â€” the fully cleaned and investigation-ready dataset.

- **[s3_enriched_events.jsonl](./cleaned_data/s3_enriched_events.jsonl)**  
  Flattened and enriched S3 activity, including `ListObjects`, `ListBuckets`, and `GetObject` events (JSONL format).

- **[s3_enriched_events.csv](./cleaned_data/s3_enriched_events.csv)**  
  CSV export of the same enriched dataset (kept for convenience).

---

### ðŸ“‚ ec2_proxy_s3_exfiltration/

The original raw dataset provided for the project (unmodified).

- **[ec2_proxy_s3_exfiltration_2020-09-14011940.jsonl](./ec2_proxy_s3_exfiltration/ec2_proxy_s3_exfiltration_2020-09-14011940.jsonl)**  
  CloudTrail JSON Lines log containing the adversaryâ€™s EC2 â†’ S3 exfiltration activity.

---

### ðŸ“‚ extended_search/

Results from `extended_search.py`, which pivoted on key Indicators of Compromise (IoCs) across the entire dataset.

- **[search_accessKeyId.jsonl](./extended_search/search_accessKeyId.jsonl)**  
  All events using the compromised `accessKeyId`:  
  `ASIA5FLZVX4OPVKKVBMX`.

- **[search_principalId.jsonl](./extended_search/search_principalId.jsonl)**  
  All events involving the compromised principal ID:  
  `AROA5FLZVX4OAMSW6BCRH:i-0317f6c6b66ae9c40`.

- **[search_userAgent.jsonl](./extended_search/search_userAgent.jsonl)**  
  Events tied to the attackerâ€™s userAgent string:  
  `[aws-cli/1.18.136 Python/3.8.5 Darwin/19.5.0 botocore/1.17.59]`.

- **[extended_search_results.jsonl](./extended_search/extended_search_results.jsonl)**  
  Combined and de-duplicated pivot results from all three indicators.

---

### ðŸ“‚ raw_data/

Previews and structural summaries generated by `parse.py`.

- **[df_preview.md](./raw_data/df_preview.md)**  
  Contains the output of `df.head()`, `df.info()`, and `df.columns.to_list()` for the original dataset.

- **[raw_preview.json](./raw_data/raw_preview.json)**  
  The first 5 raw log entries extracted directly from the original CloudTrail file.

---

### ðŸ“‚ s3_events/

Intermediate S3-only datasets generated during filtering.  
Each dataset is available in both JSONL and CSV formats (CSV is kept for legacy/reference).

- **[s3_management_events.jsonl](./s3_events/s3_management_events.jsonl)**  
  Contains S3 management events (e.g., `ListBuckets`).

- **[s3_data_events.jsonl](./s3_events/s3_data_events.jsonl)**  
  Contains S3 data events (`ListObjects`, `GetObject`).

- **[s3_all_events.jsonl](./s3_events/s3_all_events.jsonl)**  
  All S3-related events combined, with duplicates removed.

> **Note:** Each JSONL file has a matching CSV file containing the same rows.
